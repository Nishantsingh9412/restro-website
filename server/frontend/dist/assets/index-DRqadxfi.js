import{j as e,Z as I,_ as P,$ as D,aq as R,ar as u,P as o,F as r,o as v,aa as b,b as t,B as F,H as A,aB as M,aE as W,aF as B}from"./chakra-B_DUJliM.js";import{u as _,f as O}from"./redux-BFEnBRFN.js";import{r as d,h as Y}from"./react-D9OIIVWL.js";import{aP as q,r as H,aQ as C,aK as K}from"./index-C674oLPn.js";import{c as G}from"./index.esm-C2w5JDxg.js";import{a as N}from"./index.esm-D12NZOcQ.js";import{_ as y}from"./react-apexcharts.min-ApQTKi8h.js";import{s as V,e as T,a as k,b as Q,c as U}from"./subMonths-EyZRS0fZ.js";import{b as Z,c as $}from"./index.esm-pyeY5B28.js";import"./toast-D556Fe1H.js";import"./normalizeDates-DLvNHQ5D.js";import"./startOfDay-Dk20W2YO.js";import"./addMonths-BAauhxW2.js";function S({weekly:a,monthly:i,yearly:n}){const[l,s]=d.useState([]),[c,h]=d.useState([]),[f,w]=d.useState([]);d.useEffect(()=>{const x=V(),E=T({start:k(x,6),end:x}).map((m,j)=>({x:m.getTime(),y:a[j]||0})),L=T({start:k(x,29),end:x}).map((m,j)=>({x:m.getTime(),y:i[j]||0})),z=Q({start:U(x,11),end:x}).map((m,j)=>({x:m.getTime(),y:n[j]||0}));s(E),h(L),w(z)},[a,i,n]);const p={chart:{type:"area",height:350,zoom:{enabled:!0}},xaxis:{type:"datetime"},yaxis:{title:{text:"Deliveries"},tickAmount:3},stroke:{curve:"smooth"},markers:{size:4},tooltip:{x:{format:"dd MMM yyyy"}}};return e.jsxs(I,{variant:"enclosed",children:[e.jsxs(P,{children:[e.jsx(D,{children:"Last Week"}),e.jsx(D,{children:"Last Month"}),e.jsx(D,{children:"Last Year"})]}),e.jsxs(R,{children:[e.jsx(u,{children:e.jsx(y,{options:p,series:[{name:"Deliveries",data:l}],type:"area",height:350})}),e.jsx(u,{children:e.jsx(y,{options:p,series:[{name:"Deliveries",data:c}],type:"area",height:350})}),e.jsx(u,{children:e.jsx(y,{options:p,series:[{name:"Deliveries",data:f}],type:"area",height:350})})]})]})}S.propTypes={weekly:o.array.isRequired,monthly:o.array.isRequired,yearly:o.array.isRequired};const J=()=>async a=>{try{const{data:i}=await q();return a({type:"SET_DELIVERY_DASHBOARD_DATA",data:i.result}),{success:!0,message:"Dashboard data retrieved successfully"}}catch(i){return console.error("Error From Get Delivery Dashboard Action:",i),a({type:"SET_DELIVERY_DASHBOARD_DATA",data:{error:!0}}),{success:!1,message:"Something went wrong"}}},g=({title:a,icon:i,data:n,footerText:l,footerLink:s,color:c})=>{const h=Y();return e.jsxs(M,{children:[e.jsxs(W,{px:5,children:[e.jsxs(r,{justifyContent:"space-between",mb:5,children:[e.jsx(A,{fontSize:"24px",children:a}),i]}),n]}),s&&l&&e.jsxs(B,{bg:c,color:"white",px:3,py:2,display:"flex",alignItems:"center",justifyContent:"flex-end",cursor:"pointer",gap:3,onClick:()=>h(s),children:[e.jsx(t,{children:l}),e.jsx(G,{})]})]})},X=({isLoading:a,isError:i})=>a?e.jsx(t,{my:20,w:"fit-content",mx:"auto",fontSize:24,children:"Loading..."}):i?e.jsx(t,{my:20,w:"fit-content",mx:"auto",color:"red",children:"Error loading data. Please try again."}):null;function me(){const a=H(),i=_(),[n,l]=d.useState({isLoading:!0,isError:!1}),s=O(f=>f.deliveryDashboardReducer.data),c=d.useCallback(()=>{l({isLoading:!0,isError:!1}),i(J()).then(()=>l({isLoading:!1,isError:!1})).catch(()=>l({isLoading:!1,isError:!0}))},[i]),h=()=>{a("Feature coming soon!","info")};return d.useEffect(()=>{c()},[c]),e.jsxs("div",{children:[e.jsxs(r,{flexWrap:"wrap",gap:10,alignItems:"center",justifyContent:"space-between",mt:{lg:10,base:24},mb:5,children:[e.jsx(v,{leftIcon:e.jsx(Z,{}),onClick:h,children:"Create Deliveries"}),e.jsx(v,{isLoading:n.isLoading,leftIcon:e.jsx($,{}),onClick:c,children:"Refresh"})]}),e.jsx(X,{isLoading:n.isLoading,isError:n.isError}),!n.isLoading&&!n.isError&&s&&e.jsxs(e.Fragment,{children:[e.jsxs(b,{templateColumns:{base:"repeat(1, 1fr)",md:"repeat(2, 1fr)"},gap:5,children:[e.jsx(g,{title:"Deliveries Today",icon:e.jsx(C,{size:30,color:"green"}),data:e.jsxs(r,{flexDirection:{md:"row",base:"column"},justifyContent:"space-between",children:[e.jsxs(r,{flexDirection:"column",children:[e.jsx(t,{fontWeight:"500",fontSize:"larger",children:"Completed"}),e.jsx(t,{fontWeight:"600",fontSize:"xx-large",color:"green",children:s.todayCompletedDeliveries||0})]}),e.jsxs(r,{flexDirection:"column",children:[e.jsxs(r,{gap:3,children:[e.jsx(t,{children:"Active :"}),e.jsx(t,{children:s.todayActiveDeliveries||0})]}),e.jsxs(r,{gap:3,children:[e.jsx(t,{children:"Assigned :"}),e.jsx(t,{children:s.todayAssignedDeliveries||0})]}),e.jsxs(r,{gap:3,children:[e.jsx(t,{children:"Available :"}),e.jsx(t,{children:s.todayAvailableDeliveries||0})]})]})]}),footerText:"Know more",footerLink:"/employee/delivery/available-deliveries",color:"green"}),e.jsx(g,{title:"Deliveries All Time",icon:e.jsx(C,{size:30,color:"blue"}),data:e.jsxs(r,{flexDirection:{md:"row",base:"column"},justifyContent:"space-between",children:[e.jsxs(r,{flexDirection:"column",children:[e.jsx(t,{fontWeight:"500",fontSize:"larger",children:"Completed"}),e.jsx(t,{fontWeight:"600",fontSize:"xx-large",color:"blue",children:s.totalCompletedDeliveries||0})]}),e.jsxs(r,{flexDirection:"column",children:[e.jsxs(r,{gap:3,children:[e.jsx(t,{children:"Assigned :"}),e.jsx(t,{children:s.totalAssignedDeliveries||0})]}),e.jsxs(r,{gap:3,color:"red",children:[e.jsx(t,{children:"Not Completed :"}),e.jsx(t,{children:(s.totalAssignedDeliveries||0)-(s.totalCompletedDeliveries||0)})]})]})]}),footerText:"Know more",footerLink:"/employee/delivery/history",color:"blue"})]}),e.jsxs(F,{mt:5,bg:"#fff",children:[e.jsx(A,{fontSize:20,mb:5,pl:5,pt:5,children:"Deliveries Completed"}),e.jsx(S,{weekly:s.totalDeliveryCompletedPastWeekPerDay||[],monthly:s.totalDeliveryCompletedPastMonthPerDay||[],yearly:s.totalDeliveryCompletedPastYearPerMonth||[],totalInWeek:s.totalDeliveryCompletedPastWeek||0,totalInMonth:s.totalDeliveryCompletedPastMonth||0,totalInYear:s.totalDeliveryCompletedPastYear||0})]}),e.jsxs(b,{templateColumns:{base:"repeat(1, 1fr)",md:"repeat(2, 1fr)"},mt:5,gap:5,children:[e.jsx(g,{title:"Delivery Time Taken",icon:e.jsx(K,{size:30,color:"green"}),data:e.jsxs(r,{flexDirection:"column",gap:5,children:[e.jsxs(r,{flexDirection:"column",alignItems:"center",children:[e.jsx(t,{fontWeight:"500",fontSize:"larger",children:"Average"}),e.jsxs(t,{fontWeight:"600",fontSize:"xx-large",color:"green",children:[(s.averageTimeTaken/60).toFixed(1)," min."]})]}),e.jsxs(r,{flexDirection:"row",justifyContent:"space-between",children:[e.jsxs(r,{flexDirection:"column",alignItems:"center",children:[e.jsx(t,{children:"Smallest"}),e.jsxs(t,{children:[(s.smallestTimeTaken/60).toFixed(1)," min."]})]}),e.jsxs(r,{flexDirection:"column",alignItems:"center",children:[e.jsx(t,{children:"Longest"}),e.jsxs(t,{children:[(s.longestTimeTaken/60).toFixed(1)," min."]})]})]})]})}),e.jsx(g,{title:"Distance Covered",icon:e.jsx(N,{size:30,color:"green"}),data:e.jsxs(r,{flexDirection:"column",gap:5,children:[e.jsxs(r,{flexDirection:"column",alignItems:"center",children:[e.jsx(t,{fontWeight:"500",fontSize:"larger",children:"Average"}),e.jsxs(t,{fontWeight:"600",fontSize:"xx-large",color:"green",children:[(s.averageDeliveryDistance/1e3).toFixed(1)," km"]})]}),e.jsxs(r,{flexDirection:"row",justifyContent:"space-between",children:[e.jsxs(r,{flexDirection:"column",alignItems:"center",children:[e.jsx(t,{children:"Smallest"}),e.jsxs(t,{children:[(s.shortestDeliveryDistance/1e3).toFixed(1)," km"]})]}),e.jsxs(r,{flexDirection:"column",alignItems:"center",children:[e.jsx(t,{children:"Longest"}),e.jsxs(t,{children:[(s.longestDeliveryDistance/1e3).toFixed(1)," km"]})]})]})]})})]})]})]})}g.propTypes={title:o.string.isRequired,icon:o.element.isRequired,data:o.node.isRequired,footerText:o.string,footerLink:o.string,color:o.string};export{me as default};
