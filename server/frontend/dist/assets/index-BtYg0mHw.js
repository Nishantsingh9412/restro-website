import{j as e,r as N,s as G,t as Z,v as V,F as S,p as U,b as m,y as q,w as $,B as C,x as J,o as v,a1 as k,a2 as _,q as L,g as B,V as te,ac as se,M as ne,i as re,G as ae,k as ie,l as W,S as le}from"./chakra-B_DUJliM.js";import{r as p,b as ce}from"./react-D9OIIVWL.js";import{P as de,p as ue}from"./index-DBk-HpAQ.js";import{V as Y,W as he,X as me,Y as pe,Z as xe,_ as ge,$ as fe,a0 as je,r as be,S as Ce}from"./index-C674oLPn.js";import{u as E,f as z}from"./redux-BFEnBRFN.js";import{B as H,Q as Se}from"./toast-D556Fe1H.js";/* empty css                      */import{a as ye,b as we}from"./index.esm-CEhDG2xH.js";function ve(s){return Y({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M12.75 7.75a.75.75 0 0 0-1.5 0v3.5h-3.5a.75.75 0 0 0 0 1.5h3.5v3.5a.75.75 0 0 0 1.5 0v-3.5h3.5a.75.75 0 0 0 0-1.5h-3.5v-3.5Z"}},{tag:"path",attr:{d:"M12 1c6.075 0 11 4.925 11 11s-4.925 11-11 11S1 18.075 1 12 5.925 1 12 1ZM2.5 12a9.5 9.5 0 0 0 9.5 9.5 9.5 9.5 0 0 0 9.5-9.5A9.5 9.5 0 0 0 12 2.5 9.5 9.5 0 0 0 2.5 12Z"}}]})(s)}function Ie(s){return Y({tag:"svg",attr:{viewBox:"0 0 15 15",fill:"none"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M8.625 2.5C8.625 3.12132 8.12132 3.625 7.5 3.625C6.87868 3.625 6.375 3.12132 6.375 2.5C6.375 1.87868 6.87868 1.375 7.5 1.375C8.12132 1.375 8.625 1.87868 8.625 2.5ZM8.625 7.5C8.625 8.12132 8.12132 8.625 7.5 8.625C6.87868 8.625 6.375 8.12132 6.375 7.5C6.375 6.87868 6.87868 6.375 7.5 6.375C8.12132 6.375 8.625 6.87868 8.625 7.5ZM7.5 13.625C8.12132 13.625 8.625 13.1213 8.625 12.5C8.625 11.8787 8.12132 11.375 7.5 11.375C6.87868 11.375 6.375 11.8787 6.375 12.5C6.375 13.1213 6.87868 13.625 7.5 13.625Z",fill:"currentColor"}}]})(s)}const F=async(s,r,l)=>{try{const{data:n}=await s;return r&&l&&r({type:l,data:n==null?void 0:n.result}),{success:!0,message:n.message}}catch(n){return{success:!1,message:n.response.data.error||"something went wrong",status:n.response.status}}},Ae=s=>async r=>F(xe(s),r,"ADD_SUPPLIER"),K=s=>async r=>F(he(s),r,"GET_ALL_SUPPLIERS"),Q=s=>async r=>F(me(s),r,"GET_SINGLE_SUPPLIER"),Pe=()=>({type:"CLEAR_SELECTED_SUPPLIER"}),_e=(s,r)=>async l=>F(ge(s,r),l,"UPDATE_SUPPLIER"),ze=s=>async()=>{try{return await pe(s),{success:!0,message:"Supplier Deleted Successfully"}}catch(r){return{success:!1,message:r.message}}},Ee=({selectedId:s,isOpen:r,onClose:l})=>{var x,j;const n=E();p.useEffect(()=>{r&&s&&n(Q(s))},[n,s,r]);const o=z(a=>a.supplierReducer.seletectedSupplier),f=()=>{l(),n(Pe())};return e.jsxs(N,{isCentered:!0,isOpen:r,onClose:f,children:[e.jsx(G,{}),e.jsxs(Z,{maxW:"45rem",background:"#FFFFFF",color:"#ee7213",borderRadius:"lg",boxShadow:"xl",children:[e.jsx(V,{children:e.jsxs(S,{align:"center",children:[e.jsx(U,{borderRadius:"full",boxSize:"50px",src:o==null?void 0:o.pic,alt:(o==null?void 0:o.name)||"Supplier Image",fallbackSrc:"https://via.placeholder.com/150",mr:3}),e.jsx(m,{fontSize:"lg",fontWeight:"bold",color:"blue",children:o==null?void 0:o.name})]})}),e.jsx(q,{}),e.jsxs($,{children:[e.jsxs(m,{fontSize:"sm",color:"gray.600",children:["Last Updated: ",(x=o==null?void 0:o.updatedAt)==null?void 0:x.split("T")[0]]}),(o==null?void 0:o.email)&&e.jsxs(S,{align:"center",mt:3,fontSize:"sm",color:"black",children:[e.jsx(fe,{size:"20"})," ",e.jsx(m,{ml:2,children:o==null?void 0:o.email})]}),(o==null?void 0:o.phone)&&e.jsxs(S,{align:"center",mt:3,fontSize:"sm",color:"black",children:[e.jsx(ye,{size:"18"})," ",e.jsxs(m,{ml:2,children:["+",o==null?void 0:o.countryCode," - ",o==null?void 0:o.phone]})]}),(o==null?void 0:o.location)&&e.jsxs(S,{align:"center",mt:3,fontSize:"sm",color:"black",children:[e.jsx(je,{size:"20"})," ",e.jsx(m,{ml:2,children:o==null?void 0:o.location})]}),e.jsx(m,{fontSize:"lg",fontWeight:"bold",mt:6,color:"blue",children:"Items"}),e.jsx(S,{wrap:"wrap",mt:2,children:(j=o==null?void 0:o.items)==null?void 0:j.map((a,c)=>e.jsx(C,{m:1,px:3,py:1,bg:"white",border:"1px solid #ddd",borderRadius:"md",fontSize:"sm",color:"gray.700",boxShadow:"sm",children:a},c))})]}),e.jsx(J,{children:e.jsx(v,{colorScheme:"blue",onClick:f,children:"Close"})})]})]})},X=({selectedId:s,isOpen:r,onClose:l,isEdit:n})=>{var D,T;const o=(T=(D=JSON.parse(localStorage.getItem("ProfileData")))==null?void 0:D.result)==null?void 0:T._id,f={name:"",items:[],pic:"",email:"",countryCode:"",phone:"",location:"",created_by:""},x=be(),j=E(),[a,c]=p.useState(f),[y,g]=p.useState(!1),I=()=>e.jsx(G,{}),[R]=p.useState(e.jsx(I,{}));p.useEffect(()=>{s&&n&&j(Q(s))},[s,n]);const t=z(i=>i.supplierReducer.seletectedSupplier);p.useEffect(()=>{t&&n&&c({name:(t==null?void 0:t.name)||"",items:(t==null?void 0:t.items)||[],pic:(t==null?void 0:t.pic)||"",email:(t==null?void 0:t.email)||"",countryCode:(t==null?void 0:t.countryCode)||"",phone:(t==null?void 0:t.phone)||"",location:(t==null?void 0:t.location)||"",created_by:(t==null?void 0:t.created_by)||""})},[t,n]);const b=(i,d)=>{c(h=>({...h,[i]:d}))},u=i=>{if(typeof i=="string"){const d=ue(i);d&&c(h=>({...h,countryCode:d.countryCallingCode,phone:d.nationalNumber}))}},M=i=>{if(g(!0),!i||i.type!=="image/jpeg"&&i.type!=="image/png"){x("Invalid image format. Please upload JPEG or PNG.","error"),g(!1);return}if(i.size>2e6){x("Image size should be less than 2 MB","info"),g(!1);return}const d=new FormData;d.append("file",i),d.append("upload_preset","restro-website"),d.append("cloud_name","dezifvepx"),fetch("https://api.cloudinary.com/v1_1/dezifvepx/image/upload",{method:"post",body:d}).then(h=>h.json()).then(h=>{c(w=>({...w,pic:h.url.toString()})),g(!1)}).catch(h=>{x("Error Uploading Image","error"),g(!1)})},ee=i=>{i.preventDefault(),a.created_by=o,Array.isArray(a.items)||(a.items=a.items.split(", "));const h=n?t._id:void 0,w=j(n?_e(h,a):Ae(a)).then(P=>{if(P.success)return l(),P.message;throw new Error("Error in processing request")});H.promise(w,{pending:n?"Updating Supplier...":"Adding Supplier...",success:n?"Supplier Updated Successfully":"Supplier Added Successfully",error:"Error in processing supplier"}),O()},O=()=>{c(f),l()},A=(i,d,h="text",w="")=>e.jsxs(k,{id:d,isRequired:!0,children:[e.jsx(_,{children:i}),e.jsx(L,{type:h,value:a[d],placeholder:w,onChange:P=>b(d,P.target.value),_focus:{borderColor:"#ee7213",boxShadow:"0 0 0 1px #ee7213"},background:"whiteAlpha.100"})]}),oe=()=>{c({name:"Nizam",items:["Tomato","Cauliflower","Brinjal","Potato","Onion","Ginger"],pic:"",email:"nizamji100@gmail.com",countryCode:"91",phone:"9798425933",location:"Kolkata"})};return e.jsxs(N,{isCentered:!0,isOpen:r,onClose:O,children:[R,e.jsxs(Z,{background:"#F5FFFE",color:"black",children:[e.jsx(V,{children:e.jsxs(C,{display:"flex",justifyContent:"center",alignItems:"center",gap:"10px",children:[e.jsx(we,{}),e.jsx(m,{children:n?"Update Supplier":"Add Supplier"})]})}),e.jsx(q,{}),e.jsx($,{children:e.jsx(C,{maxW:"sm",m:"auto",p:"4",borderWidth:"1px",borderRadius:"lg",background:"whiteAlpha.100",children:e.jsxs("form",{onSubmit:ee,children:[A("Supplier Name","name"),A("Items (comma-separated)","items","text","Tomato, Cauliflower, Brinjal"),e.jsxs(k,{id:"phone",children:[e.jsx(_,{children:"Phone"}),e.jsx(de,{international:!0,defaultCountry:"DE",style:{width:"100%"},onChange:u,placeholder:"Phone",value:a.phone?`+${a.countryCode} ${a.phone}`:"",inputComponent:L,inputProps:{_focus:{borderColor:"#ee7213",boxShadow:"0 0 0 1px #ee7213"}}})]}),A("Email","email","email"),A("Location","location"),e.jsxs(k,{id:"pic",children:[e.jsx(_,{children:"Upload Picture"}),e.jsx(L,{type:"file",accept:"image/*",onChange:i=>M(i.target.files[0]),_focus:{borderColor:"#ee7213",boxShadow:"0 0 0 1px #ee7213"},required:!n}),a.pic||null]}),a.pic&&e.jsxs(C,{mt:4,children:[e.jsx(_,{children:"Image Preview"}),e.jsx(U,{src:a.pic,alt:"Supplier Picture",boxSize:"150px",objectFit:"cover"})]}),e.jsx(v,{mt:"4",bg:"#ee7213",color:"white",_hover:{bg:"#ff8c42"},type:"submit",isLoading:y,children:n?"Update Supplier":"Add Supplier"})]})})}),e.jsx(J,{children:e.jsx(v,{onClick:oe,children:"Auto Fill"})})]})]})},Fe=({data:s,localStorageId:r})=>{const l=E(),[n,o]=p.useState(null),{isOpen:f,onOpen:x,onClose:j}=B(),{isOpen:a,onOpen:c,onClose:y}=B(),g=p.useCallback((t,b)=>{t.preventDefault(),o(b),c()},[c]),I=p.useCallback(t=>{const b=l(ze(t)).then(u=>{if(u.success)return l(K(r)),u.message;throw new Error("Error Deleting Item")});H.promise(b,{pending:"Deleting Item...",success:"Item Deleted Successfully",error:"Error in Deleting Item"})},[l]),R=p.useCallback((t,b)=>{t.preventDefault(),Ce.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!",customClass:{popup:"swal-bg swal-border"}}).then(u=>{u.isConfirmed&&I(b)})},[I]);return e.jsxs(C,{p:2,children:[e.jsx(m,{ml:2,fontWeight:"900",color:"#049CFD",fontSize:"2xl",children:"List Of All Suppliers"}),e.jsx(S,{flexWrap:"wrap",p:2,children:s&&s.length>0?s.map((t,b)=>e.jsxs(C,{width:"270px",bg:"white",boxShadow:"lg",borderRadius:"lg",overflow:"hidden",m:3,transition:"all 0.3s ease",_hover:{transform:"scale(1.05)",boxShadow:"xl"},children:[e.jsxs(S,{justifyContent:"space-between",alignItems:"center",p:4,bg:b%2===0?"blue.50":"green.50",borderBottomWidth:"1px",borderColor:"gray.200",children:[e.jsxs(C,{children:[e.jsx(m,{fontWeight:"bold",fontSize:"lg",color:"gray.700",children:t.name}),e.jsxs(m,{fontSize:"sm",color:"gray.500",children:["Updated on ",t.updatedAt.split("T")[0]]})]}),e.jsx(U,{borderRadius:"full",boxSize:"50px",src:t.pic,alt:t.name})]}),e.jsxs(S,{justifyContent:"space-between",children:[e.jsxs(C,{p:4,children:[e.jsxs(te,{spacing:2,children:[t.items.slice(0,3).map((u,M)=>e.jsx(m,{fontSize:"sm",color:"gray.600",as:"li",children:u},M)),t.items.length>3&&e.jsxs(se,{colorScheme:"blue",fontSize:"0.8em",p:1,children:["+",t.items.length-3," more items"]})]}),e.jsx(v,{mt:3,size:"sm",variant:"solid",colorScheme:"blue",onClick:()=>{x(),o(t._id)},children:"View Details"})]}),e.jsx(C,{position:"relative",textAlign:"right",p:4,children:e.jsxs(ne,{children:[e.jsx(re,{children:e.jsx(Ie,{})}),e.jsx(ae,{children:e.jsxs(ie,{children:[e.jsx(W,{onClick:u=>g(u,t._id),children:"Edit"}),e.jsx(W,{onClick:u=>R(u,t._id),children:"Delete"})]})})]})})]})]},t._id)):e.jsx(m,{m:3,fontWeight:"600",color:"gray.500",fontSize:"lg",children:"No suppliers available."})}),e.jsx(Ee,{isOpen:f,onOpen:x,onClose:j,selectedId:n}),e.jsx(X,{isOpen:a,onOpen:c,onClose:y,selectedId:n,isEdit:!0})]})},Re=ce.memo(Fe);function We(){var c,y;const s=E(),{isOpen:r,onOpen:l,onClose:n}=B(),o=(y=(c=JSON.parse(localStorage.getItem("ProfileData")))==null?void 0:c.result)==null?void 0:y._id,f=z(g=>g.supplierReducer.suppliers),x=z(g=>g.supplierReducer.selectedSupplier),[j,a]=p.useState(!0);return p.useEffect(()=>{a(!0),s(K(o)).finally(()=>{a(!1)})},[s,o]),j?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh",color:"blue"},children:e.jsx(le,{size:"xl"})}):e.jsxs("div",{children:[e.jsx(Se,{}),e.jsx(v,{leftIcon:e.jsx(ve,{}),colorScheme:"teal",variant:"solid",onClick:l,m:3,w:{base:"100%",md:"auto"},children:"Add Supplier"}),e.jsx(Re,{data:f,selectedSupplier:x,localStorageId:o}),e.jsx(X,{isOpen:r,onClose:n})]})}export{We as default};
