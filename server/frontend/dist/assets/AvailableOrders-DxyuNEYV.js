import{j as e,B as C,F as b,p as H,b as d,o as E,P as s,H as y,a4 as K,a5 as G,S as M,aG as J,aH as $,aa as P}from"./chakra-B_DUJliM.js";import{D as Q,O as V}from"./DineInActiveOrder-CqCRGWgd.js";import{a_ as u,aI as l,ab as c,a$ as A,b0 as O,b1 as X}from"./index-C674oLPn.js";import{f as z,u as Z}from"./redux-BFEnBRFN.js";import{r as x}from"./react-D9OIIVWL.js";import"./index.esm-C8Ls1WbU.js";import"./index.esm-CEhDG2xH.js";import"./dineInOrder-Qshl_rwx.js";import"./AllotOrderModal-ut9QwBD-.js";import"./toast-D556Fe1H.js";function F({data:r,handleAccept:h,handleReject:m,disabled:g}){var p,o;return e.jsx(C,{borderRadius:10,bg:"gray.100",p:5,flex:1,children:e.jsxs(b,{flexDirection:"column",gap:5,children:[e.jsxs(b,{gap:10,alignItems:"center",children:[e.jsx(C,{width:"60px",height:"60px",borderRadius:"50%",overflow:"hidden",children:e.jsx(H,{src:r.customerImage??"https://res.cloudinary.com/dezifvepx/image/upload/v1712570097/restro-website/dtqy5kkrwuuhamtp9gim.png",alt:r.customerName})}),e.jsx(d,{fontSize:18,children:r.customerName===""?"N/A":r.customerName})]}),e.jsxs(b,{flexDirection:"column",gap:3,children:[e.jsxs(d,{children:["Order #",r.orderId]}),e.jsx(d,{bg:"gray.200",w:"fit-content",px:2,py:1,fontSize:12,borderRadius:10,children:(p=r.currentStatus)==null?void 0:p.toUpperCase()}),e.jsxs(C,{children:[e.jsx(d,{fontWeight:"bold",children:"Ordered Items:"}),e.jsx(C,{pl:3,children:(o=r==null?void 0:r.orderItems)==null?void 0:o.map((i,n)=>{var j;return e.jsxs(d,{children:[(j=i==null?void 0:i.item)==null?void 0:j.orderName," - ",i==null?void 0:i.quantity]},n)})})]}),e.jsxs(b,{gap:3,children:[e.jsx(E,{p:3,flex:1,bg:"green.500",_hover:{background:"green"},color:"#fff",_disabled:{background:"#ccc",pointerEvents:"none"},disabled:g,onClick:()=>h(r==null?void 0:r.orderId,u.TAKE_AWAY),children:"Accept"}),e.jsx(E,{p:3,flex:1,bg:"red.500",_hover:{background:"red"},color:"#fff",_disabled:{background:"#ccc",pointerEvents:"none"},disabled:g,onClick:()=>m(r.orderId),children:"Reject"})]})]})]})})}F.propTypes={data:s.shape({customerImage:s.string,customerName:s.string.isRequired,orderId:s.number.isRequired,currentStatus:s.string,tableNumber:s.number.isRequired,numberOfGuests:s.number.isRequired,orderItems:s.arrayOf(s.shape({name:s.string.isRequired,quantity:s.number.isRequired})).isRequired,specialInstructions:s.string,_id:s.string.isRequired}).isRequired,handleAccept:s.func.isRequired,handleReject:s.func.isRequired,disabled:s.bool.isRequired};const L=({activeOrder:r,handleCancel:h,handleUpdateStatus:m})=>{var p;const g=()=>{const o=["Assigned","Accepted","Preparing","Completed"],i=o.indexOf(r==null?void 0:r.currentStatus);if(i<o.length-1){const n=o[i+1];m(r.orderId,n)}};return e.jsxs(C,{p:5,shadow:"md",borderWidth:"1px",borderRadius:"md",mt:4,children:[e.jsx(y,{fontSize:"xl",children:"Active Order"}),e.jsxs(d,{mt:4,children:[e.jsx("strong",{children:"Order ID:"})," ",r==null?void 0:r.orderId]}),e.jsxs(d,{children:[e.jsx("strong",{children:"Status:"})," ",r==null?void 0:r.currentStatus]}),e.jsx(d,{mt:4,children:e.jsx("strong",{children:"Order Items:"})}),e.jsx(K,{mt:1,ml:2,children:(p=r.orderItems)==null?void 0:p.map((o,i)=>{var n;return e.jsxs(G,{children:[(n=o.item)==null?void 0:n.orderName," - ",o.quantity]},i)})}),e.jsxs(C,{mt:4,display:"flex",justifyContent:"center",gap:5,children:[e.jsx(E,{colorScheme:"teal",onClick:g,isDisabled:(r==null?void 0:r.currentStatus)===l.COMPLETED,children:(r==null?void 0:r.currentStatus)===l.COMPLETED?"Order Completed":"Update Status"}),e.jsx(E,{colorScheme:"red",onClick:()=>h(r.orderId),children:"Cancel Order"})]})]})};L.propTypes={activeOrder:s.shape({orderId:s.number.isRequired,tableNumber:s.number.isRequired,currentStatus:s.string.isRequired,orderItems:s.arrayOf(s.shape({name:s.string.isRequired,quantity:s.number.isRequired})).isRequired}).isRequired,handleCancel:s.func.isRequired,handleUpdateStatus:s.func.isRequired};function ce(){var D,k,_,N;const r=z(t=>t.chef.orders),{dineInActiveOrder:h,takeAwayActiveOrder:m}=z(t=>t.chef.activeOrder),[g,p]=x.useState(!0),[o,i]=x.useState(null),n=Z(),[j,R]=x.useState(""),[I,S]=x.useState(null),Y=t=>{n(A({orderType:u.DINE_IN,orderId:t,status:l.ACCEPTED_BY_CHEF})),console.log(l.ACCEPTED_BY_CHEF)},W=t=>{n(A({orderType:u.TAKE_AWAY,orderId:t,status:l.ACCEPTED}))},B=t=>{n(A({orderType:u.DINE_IN,orderId:t,status:l.REJECTED}))},U=t=>{n(A({orderType:u.TAKE_AWAY,orderId:t,status:l.REJECTED}))},T=t=>{n(A({orderType:j,orderId:t,status:l.CANCELLED}))},w=(t,a)=>{if(n(A({orderType:j,orderId:t,status:a})),a===l.COMPLETED)return n(O()),c.showOrderCompleted()},q=x.useCallback(()=>h?(R(u.DINE_IN),h):m?(R(u.TAKE_AWAY),m):null,[h,m]);return x.useEffect(()=>{(async()=>{try{await Promise.all([n(O()),n(X())])}catch(a){console.error("Failed to fetch orders:",a),i("Failed to fetch orders. Please try again later.")}finally{p(!1)}})()},[n]),x.useEffect(()=>{const t=q();S(t||null)},[q]),g?e.jsx(b,{justifyContent:"center",alignItems:"center",height:"50vh",children:e.jsx(M,{size:"xl"})}):o?e.jsx(b,{justifyContent:"center",alignItems:"center",height:"50vh",children:e.jsxs(J,{status:"error",children:[e.jsx($,{}),o]})}):I?j===u.TAKE_AWAY?e.jsx(L,{activeOrder:I,handleCancel:t=>c.showCancelConfirmation(t,T),handleUpdateStatus:(t,a)=>c.showStatusChangeConfirm(t,a,w)}):e.jsx(Q,{activeOrder:I,handleCancel:t=>c.showCancelConfirmation(t,T),handleUpdateStatus:(t,a)=>c.showStatusChangeConfirm(t,a,w)}):e.jsxs(e.Fragment,{children:[e.jsx(y,{mt:20,mb:5,fontSize:20,children:"Available Orders"}),r.length===0?e.jsx(d,{p:3,w:"fit-content",bg:"rgba(255, 255, 255, 0.5)",mx:"auto",my:20,children:"You don't have any order offer at this moment"}):e.jsxs(e.Fragment,{children:[e.jsx(y,{mt:10,mb:5,ml:2,fontSize:18,children:"Dine-In Orders"}),((D=r==null?void 0:r.dineInOrders)==null?void 0:D.length)===0?e.jsx(d,{p:3,w:"fit-content",bg:"rgba(255, 255, 255, 0.5)",mx:"auto",my:20,children:"No Dine-In Orders available at this moment"}):e.jsx(P,{gap:5,gridTemplateColumns:{base:"1fr",md:"1fr 1fr",lg:"1fr 1fr 1fr"},children:(k=r==null?void 0:r.dineInOrders)==null?void 0:k.map((t,a)=>e.jsx(V,{data:t,handleAccept:f=>c.showAcceptConfirmation(f,Y),handleReject:f=>c.showRejectConfirmation(f,B),disabled:!!I},a))}),e.jsx(y,{mt:10,mb:5,ml:2,fontSize:18,children:"Takeaway Orders"}),((_=r==null?void 0:r.takeAwayOrders)==null?void 0:_.length)===0?e.jsx(d,{p:3,w:"fit-content",bg:"rgba(255, 255, 255, 0.5)",mx:"auto",my:20,children:"No Takeaway Orders available at this moment"}):e.jsx(P,{gap:5,gridTemplateColumns:{base:"1fr",md:"1fr 1fr",lg:"1fr 1fr 1fr"},children:(N=r==null?void 0:r.takeAwayOrders)==null?void 0:N.map((t,a)=>e.jsx(F,{data:t,handleAccept:f=>c.showAcceptConfirmation(f,W),handleReject:f=>c.showRejectConfirmation(f,U),disabled:!!I},a))})]})]})}export{ce as default};
